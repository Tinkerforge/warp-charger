---
description: MQTT-Verbindung
---
{/* This file is autogenerated. Edit warp-charger/api_doc_generator/mqtt.py! */}
import MultilineTabs from '@site/src/components/MultilineTabs';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Admonition from '@theme/Admonition';

# MQTT-Verbindung

<Tabs groupId="hardwareType" queryString className="hidden-tabs">
<TabItem value="warp1">
## `mqtt/state` {#mqtt_state_warp1}


Der aktuelle MQTT-Zustand.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp-AbCd
```
#### Lesen
```bash
curl http://$HOST/mqtt/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp/AbCd
```
#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/state
```
        </TabItem>
    </Tabs>

```jsx
{
  "connection_state": 2,
  "connection_start": 27649,
  "connection_end": 0,
  "last_error": 0
}
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_state`<br/>int</th>
    <td>
        Zustand der Verbindung zum MQTT-Broker
        - **0** - Nicht konfiguriert
        - **1** - Nicht verbunden
        - **2** - Verbunden
        - **3** - Fehler
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`last_error`<br/>int</th>
    <td>
        Der zuletzt aufgetretene Fehler. -1 falls kein Fehler aufgetreten ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_start`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung aufgebaut wurde.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_end`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung getrennt wurde.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/config` {#mqtt_config_warp1}


Die MQTT-Konfiguration.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp/AbCd",
  "client_name": "warp-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
```bash
curl http://$HOST/mqtt/config -d '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp/AbCd",
  "client_name": "warp-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/config_update -m '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enable_mqtt`<br/>bool</th>
    <td>
        Gibt an, ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **true** - Wenn MQTT aktiviert ist.
        - **false** - Wenn MQTT deaktiviert ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`read_only`<br/>bool</th>
    <td>
        Gibt an, ob die MQTT-API nur gelesen, oder auch geschrieben werden darf.
        - **true** - Wenn die MQTT-API nur gelesen werden darf.
        - **false** - Wenn die MQTT-API gelesen und geschrieben werden darf.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`protocol`<br/>int</th>
    <td>
        Das zu verwendende MQTT-Protokoll
        - **0** - MQTT (MQTT über TCP; unverschlüsselt)
        - **1** - MQTTS (MQTT über TLS; verschlüsselt)
        - **2** - WS (MQTT über WebSocket; unverschlüsselt)
        - **3** - WSS (MQTT über WebSocket Secure bzw. MQTT über WebSocket über TLS; verschlüsselt)
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_host`<br/>string</th>
    <td>
        Hostname oder IP-Adresse des MQTT-Brokers, zu dem sich das Gerät verbinden soll.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_port`<br/>int</th>
    <td>
        Port des MQTT-Brokers zu dem sich das Gerät verbinden soll. Typischerweise 1883.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_username`<br/>string</th>
    <td>
        Username mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentifizierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_password`<br/>string</th>
    <td>
        Passwort mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentisierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`global_topic_prefix`<br/>string</th>
    <td>
        Präfix der allen MQTT-Topics vorangestellt wird. Normalerweise warp/[UID des Geräts] bzw. warp2/[UID des Geräts].
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_name`<br/>string</th>
    <td>
        Name unter dem sich das Gerät beim Broker registriert. <strong>Das ist nicht der Username zur Authentisierung.</strong>
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`interval`<br/>int (<abbr title="Sekunde">s</abbr>)</th>
    <td>
        Minimales Sendeintervall pro Topic in Sekunden. Nachrichten werden grundsätzlich nur verschickt, wenn Änderungen am Payload vorliegen. Durch ein Sendeintervall von x Sekunden wird alle x Sekunden höchstens eine Nachricht eines Topics verschickt. Falls sich der Inhalt in x Sekunden mehrfach ändert wird nur der aktuellste Inhalt übertragen.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`path`<br/>string</th>
    <td>
        Teil der MQTT-über-WS-URL hinter dem Hostnamen. Muss mit / beginnen. Wird ignoriert wenn "protocol" 0 oder 1 gewählt sind.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cert_id`<br/>int</th>
    <td>
        ID des CA-Zertifikats, dass zur Prüfung des Zertifikats des MQTTS bzw. WSS-Servers benutzt wird. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Verwende eingebettetes Zertifikatsbundle
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_cert_id`<br/>int</th>
    <td>
        ID des Client-Zertifikats, dass zum Aufbau einer TLS-verschlüsselten Verbindung verwendet werden soll. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_key_id`<br/>int</th>
    <td>
        ID des Zertifikats-Keys mit dem das Client-Zertifikat verschlüsselt ist. (Optional) Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/auto_discovery_config` {#mqtt_auto_discovery_config_warp1}


Die Konfiguration der MQTT Auto Discovery.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
```bash
curl http://$HOST/mqtt/auto_discovery_config -d '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/auto_discovery_config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/auto_discovery_config_update -m '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_mode`<br/>int</th>
    <td>
        Gibt an ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **0** - Auto Discovery deaktiviert
        - **1** - Auto Discovery im generischen Modus; Kompatibel zu z.B. openHAB und Domoticz
        - **2** - Auto Discovery im Home-Assistant-Modus
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_prefix`<br/>string</th>
    <td>
        Präfix auf den die für Auto Discovery verwendeten Informationen gesendet werden. Typischerweise homeassistent
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="warp2">
## `mqtt/state` {#mqtt_state_warp2}


Der aktuelle MQTT-Zustand.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp2-AbCd
```
#### Lesen
```bash
curl http://$HOST/mqtt/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp2/AbCd
```
#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/state
```
        </TabItem>
    </Tabs>

```jsx
{
  "connection_state": 2,
  "connection_start": 27649,
  "connection_end": 0,
  "last_error": 0
}
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_state`<br/>int</th>
    <td>
        Zustand der Verbindung zum MQTT-Broker
        - **0** - Nicht konfiguriert
        - **1** - Nicht verbunden
        - **2** - Verbunden
        - **3** - Fehler
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`last_error`<br/>int</th>
    <td>
        Der zuletzt aufgetretene Fehler. -1 falls kein Fehler aufgetreten ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_start`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung aufgebaut wurde.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_end`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung getrennt wurde.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/config` {#mqtt_config_warp2}


Die MQTT-Konfiguration.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp2-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp2-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp2/AbCd",
  "client_name": "warp2-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
```bash
curl http://$HOST/mqtt/config -d '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp2/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp2-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp2/AbCd",
  "client_name": "warp2-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/config_update -m '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enable_mqtt`<br/>bool</th>
    <td>
        Gibt an, ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **true** - Wenn MQTT aktiviert ist.
        - **false** - Wenn MQTT deaktiviert ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`read_only`<br/>bool</th>
    <td>
        Gibt an, ob die MQTT-API nur gelesen, oder auch geschrieben werden darf.
        - **true** - Wenn die MQTT-API nur gelesen werden darf.
        - **false** - Wenn die MQTT-API gelesen und geschrieben werden darf.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`protocol`<br/>int</th>
    <td>
        Das zu verwendende MQTT-Protokoll
        - **0** - MQTT (MQTT über TCP; unverschlüsselt)
        - **1** - MQTTS (MQTT über TLS; verschlüsselt)
        - **2** - WS (MQTT über WebSocket; unverschlüsselt)
        - **3** - WSS (MQTT über WebSocket Secure bzw. MQTT über WebSocket über TLS; verschlüsselt)
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_host`<br/>string</th>
    <td>
        Hostname oder IP-Adresse des MQTT-Brokers, zu dem sich das Gerät verbinden soll.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_port`<br/>int</th>
    <td>
        Port des MQTT-Brokers zu dem sich das Gerät verbinden soll. Typischerweise 1883.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_username`<br/>string</th>
    <td>
        Username mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentifizierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_password`<br/>string</th>
    <td>
        Passwort mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentisierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`global_topic_prefix`<br/>string</th>
    <td>
        Präfix der allen MQTT-Topics vorangestellt wird. Normalerweise warp/[UID des Geräts] bzw. warp2/[UID des Geräts].
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_name`<br/>string</th>
    <td>
        Name unter dem sich das Gerät beim Broker registriert. <strong>Das ist nicht der Username zur Authentisierung.</strong>
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`interval`<br/>int (<abbr title="Sekunde">s</abbr>)</th>
    <td>
        Minimales Sendeintervall pro Topic in Sekunden. Nachrichten werden grundsätzlich nur verschickt, wenn Änderungen am Payload vorliegen. Durch ein Sendeintervall von x Sekunden wird alle x Sekunden höchstens eine Nachricht eines Topics verschickt. Falls sich der Inhalt in x Sekunden mehrfach ändert wird nur der aktuellste Inhalt übertragen.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`path`<br/>string</th>
    <td>
        Teil der MQTT-über-WS-URL hinter dem Hostnamen. Muss mit / beginnen. Wird ignoriert wenn "protocol" 0 oder 1 gewählt sind.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cert_id`<br/>int</th>
    <td>
        ID des CA-Zertifikats, dass zur Prüfung des Zertifikats des MQTTS bzw. WSS-Servers benutzt wird. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Verwende eingebettetes Zertifikatsbundle
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_cert_id`<br/>int</th>
    <td>
        ID des Client-Zertifikats, dass zum Aufbau einer TLS-verschlüsselten Verbindung verwendet werden soll. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_key_id`<br/>int</th>
    <td>
        ID des Zertifikats-Keys mit dem das Client-Zertifikat verschlüsselt ist. (Optional) Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/auto_discovery_config` {#mqtt_auto_discovery_config_warp2}


Die Konfiguration der MQTT Auto Discovery.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp2-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
```bash
curl http://$HOST/mqtt/auto_discovery_config -d '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp2/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/auto_discovery_config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/auto_discovery_config_update -m '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_mode`<br/>int</th>
    <td>
        Gibt an ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **0** - Auto Discovery deaktiviert
        - **1** - Auto Discovery im generischen Modus; Kompatibel zu z.B. openHAB und Domoticz
        - **2** - Auto Discovery im Home-Assistant-Modus
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_prefix`<br/>string</th>
    <td>
        Präfix auf den die für Auto Discovery verwendeten Informationen gesendet werden. Typischerweise homeassistent
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="warp3">
## `mqtt/state` {#mqtt_state_warp3}


Der aktuelle MQTT-Zustand.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp3-AbCd
```
#### Lesen
```bash
curl http://$HOST/mqtt/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp3/AbCd
```
#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/state
```
        </TabItem>
    </Tabs>

```jsx
{
  "connection_state": 2,
  "connection_start": 27649,
  "connection_end": 0,
  "last_error": 0
}
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_state`<br/>int</th>
    <td>
        Zustand der Verbindung zum MQTT-Broker
        - **0** - Nicht konfiguriert
        - **1** - Nicht verbunden
        - **2** - Verbunden
        - **3** - Fehler
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`last_error`<br/>int</th>
    <td>
        Der zuletzt aufgetretene Fehler. -1 falls kein Fehler aufgetreten ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_start`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung aufgebaut wurde.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_end`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung getrennt wurde.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/config` {#mqtt_config_warp3}


Die MQTT-Konfiguration.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp3-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp3-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp3/AbCd",
  "client_name": "warp3-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
```bash
curl http://$HOST/mqtt/config -d '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp3/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp3-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp3/AbCd",
  "client_name": "warp3-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/config_update -m '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enable_mqtt`<br/>bool</th>
    <td>
        Gibt an, ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **true** - Wenn MQTT aktiviert ist.
        - **false** - Wenn MQTT deaktiviert ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`read_only`<br/>bool</th>
    <td>
        Gibt an, ob die MQTT-API nur gelesen, oder auch geschrieben werden darf.
        - **true** - Wenn die MQTT-API nur gelesen werden darf.
        - **false** - Wenn die MQTT-API gelesen und geschrieben werden darf.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`protocol`<br/>int</th>
    <td>
        Das zu verwendende MQTT-Protokoll
        - **0** - MQTT (MQTT über TCP; unverschlüsselt)
        - **1** - MQTTS (MQTT über TLS; verschlüsselt)
        - **2** - WS (MQTT über WebSocket; unverschlüsselt)
        - **3** - WSS (MQTT über WebSocket Secure bzw. MQTT über WebSocket über TLS; verschlüsselt)
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_host`<br/>string</th>
    <td>
        Hostname oder IP-Adresse des MQTT-Brokers, zu dem sich das Gerät verbinden soll.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_port`<br/>int</th>
    <td>
        Port des MQTT-Brokers zu dem sich das Gerät verbinden soll. Typischerweise 1883.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_username`<br/>string</th>
    <td>
        Username mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentifizierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_password`<br/>string</th>
    <td>
        Passwort mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentisierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`global_topic_prefix`<br/>string</th>
    <td>
        Präfix der allen MQTT-Topics vorangestellt wird. Normalerweise warp/[UID des Geräts] bzw. warp2/[UID des Geräts].
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_name`<br/>string</th>
    <td>
        Name unter dem sich das Gerät beim Broker registriert. <strong>Das ist nicht der Username zur Authentisierung.</strong>
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`interval`<br/>int (<abbr title="Sekunde">s</abbr>)</th>
    <td>
        Minimales Sendeintervall pro Topic in Sekunden. Nachrichten werden grundsätzlich nur verschickt, wenn Änderungen am Payload vorliegen. Durch ein Sendeintervall von x Sekunden wird alle x Sekunden höchstens eine Nachricht eines Topics verschickt. Falls sich der Inhalt in x Sekunden mehrfach ändert wird nur der aktuellste Inhalt übertragen.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`path`<br/>string</th>
    <td>
        Teil der MQTT-über-WS-URL hinter dem Hostnamen. Muss mit / beginnen. Wird ignoriert wenn "protocol" 0 oder 1 gewählt sind.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cert_id`<br/>int</th>
    <td>
        ID des CA-Zertifikats, dass zur Prüfung des Zertifikats des MQTTS bzw. WSS-Servers benutzt wird. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Verwende eingebettetes Zertifikatsbundle
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_cert_id`<br/>int</th>
    <td>
        ID des Client-Zertifikats, dass zum Aufbau einer TLS-verschlüsselten Verbindung verwendet werden soll. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_key_id`<br/>int</th>
    <td>
        ID des Zertifikats-Keys mit dem das Client-Zertifikat verschlüsselt ist. (Optional) Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/auto_discovery_config` {#mqtt_auto_discovery_config_warp3}


Die Konfiguration der MQTT Auto Discovery.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp3-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
```bash
curl http://$HOST/mqtt/auto_discovery_config -d '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp3/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/auto_discovery_config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/auto_discovery_config_update -m '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_mode`<br/>int</th>
    <td>
        Gibt an ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **0** - Auto Discovery deaktiviert
        - **1** - Auto Discovery im generischen Modus; Kompatibel zu z.B. openHAB und Domoticz
        - **2** - Auto Discovery im Home-Assistant-Modus
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_prefix`<br/>string</th>
    <td>
        Präfix auf den die für Auto Discovery verwendeten Informationen gesendet werden. Typischerweise homeassistent
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="wem">
## `mqtt/state` {#mqtt_state_wem}


Der aktuelle MQTT-Zustand.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. wem-AbCd
```
#### Lesen
```bash
curl http://$HOST/mqtt/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. wem/AbCd
```
#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/state
```
        </TabItem>
    </Tabs>

```jsx
{
  "connection_state": 2,
  "connection_start": 27649,
  "connection_end": 0,
  "last_error": 0
}
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_state`<br/>int</th>
    <td>
        Zustand der Verbindung zum MQTT-Broker
        - **0** - Nicht konfiguriert
        - **1** - Nicht verbunden
        - **2** - Verbunden
        - **3** - Fehler
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`last_error`<br/>int</th>
    <td>
        Der zuletzt aufgetretene Fehler. -1 falls kein Fehler aufgetreten ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_start`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung aufgebaut wurde.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_end`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung getrennt wurde.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/config` {#mqtt_config_wem}


Die MQTT-Konfiguration.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. wem-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wem_unterverteilung",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "wem/unterverteilung",
  "client_name": "wem_unterverteilung",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
```bash
curl http://$HOST/mqtt/config -d '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wem_unterverteilung",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wem/unterverteilung",
  "client_name": "wem_unterverteilung",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. wem/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wem_unterverteilung",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "wem/unterverteilung",
  "client_name": "wem_unterverteilung",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/config_update -m '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wem_unterverteilung",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wem/unterverteilung",
  "client_name": "wem_unterverteilung",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enable_mqtt`<br/>bool</th>
    <td>
        Gibt an, ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **true** - Wenn MQTT aktiviert ist.
        - **false** - Wenn MQTT deaktiviert ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`read_only`<br/>bool</th>
    <td>
        Gibt an, ob die MQTT-API nur gelesen, oder auch geschrieben werden darf.
        - **true** - Wenn die MQTT-API nur gelesen werden darf.
        - **false** - Wenn die MQTT-API gelesen und geschrieben werden darf.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`protocol`<br/>int</th>
    <td>
        Das zu verwendende MQTT-Protokoll
        - **0** - MQTT (MQTT über TCP; unverschlüsselt)
        - **1** - MQTTS (MQTT über TLS; verschlüsselt)
        - **2** - WS (MQTT über WebSocket; unverschlüsselt)
        - **3** - WSS (MQTT über WebSocket Secure bzw. MQTT über WebSocket über TLS; verschlüsselt)
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_host`<br/>string</th>
    <td>
        Hostname oder IP-Adresse des MQTT-Brokers, zu dem sich das Gerät verbinden soll.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_port`<br/>int</th>
    <td>
        Port des MQTT-Brokers zu dem sich das Gerät verbinden soll. Typischerweise 1883.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_username`<br/>string</th>
    <td>
        Username mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentifizierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_password`<br/>string</th>
    <td>
        Passwort mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentisierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`global_topic_prefix`<br/>string</th>
    <td>
        Präfix der allen MQTT-Topics vorangestellt wird. Normalerweise warp/[UID des Geräts] bzw. warp2/[UID des Geräts].
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_name`<br/>string</th>
    <td>
        Name unter dem sich das Gerät beim Broker registriert. <strong>Das ist nicht der Username zur Authentisierung.</strong>
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`interval`<br/>int (<abbr title="Sekunde">s</abbr>)</th>
    <td>
        Minimales Sendeintervall pro Topic in Sekunden. Nachrichten werden grundsätzlich nur verschickt, wenn Änderungen am Payload vorliegen. Durch ein Sendeintervall von x Sekunden wird alle x Sekunden höchstens eine Nachricht eines Topics verschickt. Falls sich der Inhalt in x Sekunden mehrfach ändert wird nur der aktuellste Inhalt übertragen.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`path`<br/>string</th>
    <td>
        Teil der MQTT-über-WS-URL hinter dem Hostnamen. Muss mit / beginnen. Wird ignoriert wenn "protocol" 0 oder 1 gewählt sind.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cert_id`<br/>int</th>
    <td>
        ID des CA-Zertifikats, dass zur Prüfung des Zertifikats des MQTTS bzw. WSS-Servers benutzt wird. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Verwende eingebettetes Zertifikatsbundle
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_cert_id`<br/>int</th>
    <td>
        ID des Client-Zertifikats, dass zum Aufbau einer TLS-verschlüsselten Verbindung verwendet werden soll. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_key_id`<br/>int</th>
    <td>
        ID des Zertifikats-Keys mit dem das Client-Zertifikat verschlüsselt ist. (Optional) Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="wem2">
## `mqtt/state` {#mqtt_state_wem2}


Der aktuelle MQTT-Zustand.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. wem2-AbCd
```
#### Lesen
```bash
curl http://$HOST/mqtt/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. wem2/AbCd
```
#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/state
```
        </TabItem>
    </Tabs>

```jsx
{
  "connection_state": 2,
  "connection_start": 27649,
  "connection_end": 0,
  "last_error": 0
}
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_state`<br/>int</th>
    <td>
        Zustand der Verbindung zum MQTT-Broker
        - **0** - Nicht konfiguriert
        - **1** - Nicht verbunden
        - **2** - Verbunden
        - **3** - Fehler
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`last_error`<br/>int</th>
    <td>
        Der zuletzt aufgetretene Fehler. -1 falls kein Fehler aufgetreten ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_start`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung aufgebaut wurde.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_end`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung getrennt wurde.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/config` {#mqtt_config_wem2}


Die MQTT-Konfiguration.


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enable_mqtt`<br/>bool</th>
    <td>
        Gibt an, ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        - **true** - Wenn MQTT aktiviert ist.
        - **false** - Wenn MQTT deaktiviert ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`read_only`<br/>bool</th>
    <td>
        Gibt an, ob die MQTT-API nur gelesen, oder auch geschrieben werden darf.
        - **true** - Wenn die MQTT-API nur gelesen werden darf.
        - **false** - Wenn die MQTT-API gelesen und geschrieben werden darf.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`protocol`<br/>int</th>
    <td>
        Das zu verwendende MQTT-Protokoll
        - **0** - MQTT (MQTT über TCP; unverschlüsselt)
        - **1** - MQTTS (MQTT über TLS; verschlüsselt)
        - **2** - WS (MQTT über WebSocket; unverschlüsselt)
        - **3** - WSS (MQTT über WebSocket Secure bzw. MQTT über WebSocket über TLS; verschlüsselt)
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_host`<br/>string</th>
    <td>
        Hostname oder IP-Adresse des MQTT-Brokers, zu dem sich das Gerät verbinden soll.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_port`<br/>int</th>
    <td>
        Port des MQTT-Brokers zu dem sich das Gerät verbinden soll. Typischerweise 1883.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_username`<br/>string</th>
    <td>
        Username mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentifizierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_password`<br/>string</th>
    <td>
        Passwort mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentisierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`global_topic_prefix`<br/>string</th>
    <td>
        Präfix der allen MQTT-Topics vorangestellt wird. Normalerweise warp/[UID des Geräts] bzw. warp2/[UID des Geräts].
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_name`<br/>string</th>
    <td>
        Name unter dem sich das Gerät beim Broker registriert. <strong>Das ist nicht der Username zur Authentisierung.</strong>
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`interval`<br/>int (<abbr title="Sekunde">s</abbr>)</th>
    <td>
        Minimales Sendeintervall pro Topic in Sekunden. Nachrichten werden grundsätzlich nur verschickt, wenn Änderungen am Payload vorliegen. Durch ein Sendeintervall von x Sekunden wird alle x Sekunden höchstens eine Nachricht eines Topics verschickt. Falls sich der Inhalt in x Sekunden mehrfach ändert wird nur der aktuellste Inhalt übertragen.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`path`<br/>string</th>
    <td>
        Teil der MQTT-über-WS-URL hinter dem Hostnamen. Muss mit / beginnen. Wird ignoriert wenn "protocol" 0 oder 1 gewählt sind.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cert_id`<br/>int</th>
    <td>
        ID des CA-Zertifikats, dass zur Prüfung des Zertifikats des MQTTS bzw. WSS-Servers benutzt wird. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Verwende eingebettetes Zertifikatsbundle
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_cert_id`<br/>int</th>
    <td>
        ID des Client-Zertifikats, dass zum Aufbau einer TLS-verschlüsselten Verbindung verwendet werden soll. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_key_id`<br/>int</th>
    <td>
        ID des Zertifikats-Keys mit dem das Client-Zertifikat verschlüsselt ist. (Optional) Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="any">
## `mqtt/state` {#mqtt_state_any}


Der aktuelle MQTT-Zustand.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp-AbCd
```
#### Lesen
```bash
curl http://$HOST/mqtt/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp/AbCd
```
#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/state
```
        </TabItem>
    </Tabs>

```jsx
{
  "connection_state": 2,
  "connection_start": 27649,
  "connection_end": 0,
  "last_error": 0
}
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_state`<br/>int</th>
    <td>
        Zustand der Verbindung zum MQTT-Broker
        
        
        
        - **0** - Nicht konfiguriert
        - **1** - Nicht verbunden
        - **2** - Verbunden
        - **3** - Fehler
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`last_error`<br/>int</th>
    <td>
        Der zuletzt aufgetretene Fehler. -1 falls kein Fehler aufgetreten ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_start`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung aufgebaut wurde.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`connection_end`<br/>int (<abbr title="Millisekunde">ms</abbr>)</th>
    <td>
        Zeit in Millisekunden zu der die letzte Verbindung getrennt wurde.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/config` {#mqtt_config_any}


Die MQTT-Konfiguration.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp/AbCd",
  "client_name": "warp-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
```bash
curl http://$HOST/mqtt/config -d '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/config
```
```jsx
{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "warp-AbCd",
  // highlight-start
  // Wird nicht zurückgegeben
  "broker_password": null,
  // highlight-end
  "global_topic_prefix": "warp/AbCd",
  "client_name": "warp-AbCd",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/config_update -m '{
  "enable_mqtt": true,
  "broker_host": "my_mosquitto.localdomain",
  "broker_port": 1883,
  "broker_username": "wallbox-garage",
  "broker_password": "meinpasswort",
  "global_topic_prefix": "wallbox/garage",
  "client_name": "wallbox-garage",
  "interval": 1,
  "protocol": 0,
  "cert_id": -1,
  "client_cert_id": -1,
  "client_key_id": -1,
  "path": ""
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enable_mqtt`<br/>bool</th>
    <td>
        Gibt an, ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        
        
        
        - **true** - Wenn MQTT aktiviert ist.
        - **false** - Wenn MQTT deaktiviert ist.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`read_only`<br/>bool</th>
    <td>
        Gibt an, ob die MQTT-API nur gelesen, oder auch geschrieben werden darf.
        
        
        
        - **true** - Wenn die MQTT-API nur gelesen werden darf.
        - **false** - Wenn die MQTT-API gelesen und geschrieben werden darf.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`protocol`<br/>int</th>
    <td>
        Das zu verwendende MQTT-Protokoll
        
        
        
        - **0** - MQTT (MQTT über TCP; unverschlüsselt)
        - **1** - MQTTS (MQTT über TLS; verschlüsselt)
        - **2** - WS (MQTT über WebSocket; unverschlüsselt)
        - **3** - WSS (MQTT über WebSocket Secure bzw. MQTT über WebSocket über TLS; verschlüsselt)
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_host`<br/>string</th>
    <td>
        Hostname oder IP-Adresse des MQTT-Brokers, zu dem sich das Gerät verbinden soll.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_port`<br/>int</th>
    <td>
        Port des MQTT-Brokers zu dem sich das Gerät verbinden soll. Typischerweise 1883.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_username`<br/>string</th>
    <td>
        Username mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentifizierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`broker_password`<br/>string</th>
    <td>
        Passwort mit dem sich zum Broker verbunden werden soll. Leer falls keine Authentisierung verwendet wird.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`global_topic_prefix`<br/>string</th>
    <td>
        Präfix der allen MQTT-Topics vorangestellt wird. Normalerweise warp/[UID des Geräts] bzw. warp2/[UID des Geräts].
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_name`<br/>string</th>
    <td>
        Name unter dem sich das Gerät beim Broker registriert. <strong>Das ist nicht der Username zur Authentisierung.</strong>
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`interval`<br/>int (<abbr title="Sekunde">s</abbr>)</th>
    <td>
        Minimales Sendeintervall pro Topic in Sekunden. Nachrichten werden grundsätzlich nur verschickt, wenn Änderungen am Payload vorliegen. Durch ein Sendeintervall von x Sekunden wird alle x Sekunden höchstens eine Nachricht eines Topics verschickt. Falls sich der Inhalt in x Sekunden mehrfach ändert wird nur der aktuellste Inhalt übertragen.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`path`<br/>string</th>
    <td>
        Teil der MQTT-über-WS-URL hinter dem Hostnamen. Muss mit / beginnen. Wird ignoriert wenn "protocol" 0 oder 1 gewählt sind.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cert_id`<br/>int</th>
    <td>
        ID des CA-Zertifikats, dass zur Prüfung des Zertifikats des MQTTS bzw. WSS-Servers benutzt wird. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        
        
        
        - **-1** - Verwende eingebettetes Zertifikatsbundle
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_cert_id`<br/>int</th>
    <td>
        ID des Client-Zertifikats, dass zum Aufbau einer TLS-verschlüsselten Verbindung verwendet werden soll. Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        
        
        
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`client_key_id`<br/>int</th>
    <td>
        ID des Zertifikats-Keys mit dem das Client-Zertifikat verschlüsselt ist. (Optional) Siehe [`certs/state`](/mqtt_http/api_reference/certs.mdx#certs_state)
        
        
        
        - **-1** - Nicht verwendet
        - **>= 0** - Verwende Zertifikat mit dieser ID
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `mqtt/auto_discovery_config` {#mqtt_auto_discovery_config_any}

**Benötigt das Feature <a href="#features_evse"><code>"evse"</code></a>**
Die Konfiguration der MQTT Auto Discovery.
:::info[Beispiel]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST z.B. warp-AbCd
```

#### Lesen
```bash
curl http://$HOST/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
```bash
curl http://$HOST/mqtt/auto_discovery_config -d '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER z.B. my_mosquitto.localdomain
# $PREFIX z.B. warp/AbCd
```

#### Lesen
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/mqtt/auto_discovery_config
```
```jsx
{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }
```



#### Schreiben
            Mit MQTT auf <code>$PREFIX/mqtt/auto_discovery_config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/mqtt/auto_discovery_config_update -m '{ "auto_discovery_mode": 2, "auto_discovery_prefix": "homeassistant" }'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Bedeutung</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_mode`<br/>int</th>
    <td>
        Gibt an ob eine MQTT-Verbindung zum konfigurierten Broker aufgebaut werden soll.
        
        
        
        - **0** - Auto Discovery deaktiviert
        - **1** - Auto Discovery im generischen Modus; Kompatibel zu z.B. openHAB und Domoticz
        - **2** - Auto Discovery im Home-Assistant-Modus
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`auto_discovery_prefix`<br/>string</th>
    <td>
        Präfix auf den die für Auto Discovery verwendeten Informationen gesendet werden. Typischerweise homeassistent
    </td>
</tr>
    </tbody>
</table>
</TabItem>
</Tabs>

export const toc = [
    {
    "value": "mqtt/state",
    "id": "mqtt_state",
    "level": 2,
    
},{
    "value": "mqtt/config",
    "id": "mqtt_config",
    "level": 2,
    
},{
    "value": "mqtt/auto_discovery_config",
    "id": "mqtt_auto_discovery_config",
    "level": 2,
    "hardwareType": ["warp1","warp2","warp3"]
},
];
