---
description: PV Excess Charging Configuration
---
{/* This file is autogenerated. Edit warp-charger/api_doc_generator/power_manager.py! */}
import MultilineTabs from '@site/src/components/MultilineTabs';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import Admonition from '@theme/Admonition';

# PV Excess Charging Configuration

<Tabs groupId="hardwareType" queryString className="hidden-tabs">
<TabItem value="warp1">
## `power_manager/config` {#power_manager_config_warp1}


Power Manager configuration
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
```bash
curl http://$HOST/power_manager/config -d '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/config_update -m '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Obsolete. Indicates whether the Power Manager is enabled. This value is automatically overwritten depending on whether PV excess charging or dynamic load management is enabled.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`default_mode`<br/>int</th>
    <td>
        The charge mode used after a Power Manager restart
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`excess_charging_enable`<br/>bool</th>
    <td>
        If enabled, the Power Manager controls the consumers it manages based on the excess of an existing photovoltaic system. If disabled, the maximum power is allowed while complying with the maximum current capacity of the supply lines.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phase_switching_mode`<br/>int</th>
    <td>
        
        - **0** - Automatic switching between three-phase and single-phase charging. Only possible if contactor_installed is true.
        - **1** - Always single-phase
        - **2** - Always three-phase
        - **4** - Single-phase PV mode, three-phase fast mode
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`target_power_from_grid`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Target grid power for excess control. Specifies the desired grid consumption (positive values) or grid feed-in (negative values) in PV charging mode. This can also influence the priority relative to a battery storage system.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`guaranteed_power`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Minimum charging power used for Min + PV charging mode. This power is (partially) drawn from the grid when PV excess is insufficient.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cloud_filter_mode`<br/>int</th>
    <td>
        Cloud filter mode to avoid overreactions to short-term changes in cloud cover in PV charging mode.
        - **0** - No cloud filter.
        - **1** - Weak cloud filter.
        - **2** - Medium cloud filter.
        - **3** - Strong cloud filter.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_battery_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the battery storage meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_mode`<br/>int</th>
    <td>
        Storage priority relative to wallboxes
        - **0** - Prefer wallboxes, excess power for storage
        - **1** - Prefer storage, excess power for wallboxes
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_inverted`<br/>bool</th>
    <td>
        Inverts the sign of storage power for battery storage systems that report negative power values when charging and positive values when discharging.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_deadzone`<br/>int</th>
    <td>
        Grid consumption and feed-in tolerance at the grid connection while storage is active. For battery storage systems that allow a certain amount of consumption and feed-in during discharging or charging. The tolerance should be set to 1.5 times the expected consumption and feed-in.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/dynamic_load_config` {#power_manager_dynamic_load_config_warp1}


Dynamic load management configuration


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Enables dynamic load management.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_currents`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`current_limit`<br/>int</th>
    <td>
        Maximum desired current at the grid connection in milliamperes. This is typically the rated value of the fuse.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`largest_consumer_current`<br/>int</th>
    <td>
        Current demand of the largest individual consumer per phase in milliamperes, excluding controlled wallboxes.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`safety_margin_pct`<br/>int</th>
    <td>
        Additional safety margin in percent, relative to the maximum current at the grid connection.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/state` {#power_manager_state_warp1}


Power Manager state
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/state
```
        </TabItem>
    </Tabs>

```jsx
{ "config_error_flags": 0, "external_control": 1 }
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`config_error_flags`<br/>int</th>
    <td>
        Active configuration errors of the Power Manager. This is a bitmask, so any combination of configuration errors can occur.
        - **0** - No error
        - **0x00000001** - Phase switching or contactor not configured
        - **0x00000002** - Maximum total current of wallboxes not configured
        - **0x00000004** - No wallboxes configured
        - **0x00000008** - Excess charging enabled but no electricity meter configured
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`external_control`<br/>int</th>
    <td>
        Status of external control for phase switching.
        - **0** - External control ready for commands.
        - **1** - External control disabled via settings.
        - **2** - External control is enabled but currently unavailable. Reasons include: triggered contactor monitoring, one or more wallboxes unreachable or do not support CP disconnect, charging session blocked by input 3.
        - **3** - Phase switching is currently being performed; incoming commands are ignored.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/low_level_state` {#power_manager_low_level_state_warp1}


The internal state of the Power Manager. Used for displaying debug information. <strong>Changes to this object are not considered an API breaking change!</strong>
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/low_level_state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/low_level_state
```
        </TabItem>
    </Tabs>

```jsx
{
  "power_at_meter": -4067.817383,
  "power_at_meter_filtered": -4909,
  "power_available": 3680,
  "power_available_filtered": 3680,
  "overall_min_power": 1380,
  "threshold_3to1": 3795,
  "threshold_1to3": 4025,
  "charge_manager_available_current": 16000,
  "charge_manager_allocated_current": 16000,
  "max_current_limited": 16000,
  "uptime_past_hysteresis": true,
  "is_3phase": false,
  "wants_3phase": false,
  "wants_3phase_last": false,
  "is_on_last": true,
  "wants_on_last": true,
  "phase_state_change_blocked": false,
  "phase_state_change_delay": 0,
  "on_state_change_blocked": true,
  "on_state_change_delay": 194264,
  "charging_blocked": 0,
  "switching_state": 0
}
```


:::



<br/><br/><br/>
## `power_manager/charge_mode` {#power_manager_charge_mode_warp1}


Currently used charge mode.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
```bash
curl http://$HOST/power_manager/charge_mode -d '{ "mode": 2 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/charge_mode -d '2'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/charge_mode<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '{ "mode": 2 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '2'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`mode`<br/>int</th>
    <td>
        
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/external_control` {#power_manager_external_control_warp1}


Phase request for external control. Can be written when external_control in [`power_manager/state`](/interfaces/mqtt_http/api_reference/power_manager.mdx#power_manager_state) is 0.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
```bash
curl http://$HOST/power_manager/external_control -d '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/external_control -d '1'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/external_control<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '1'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phases_wanted`<br/>int</th>
    <td>
        
        - **0** - No phases requested, no current release.
        - **1** - One phase requested.
        - **3** - Three phases requested.
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="warp2">
## `power_manager/config` {#power_manager_config_warp2}


Power Manager configuration
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp2-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
```bash
curl http://$HOST/power_manager/config -d '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp2/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/config_update -m '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Obsolete. Indicates whether the Power Manager is enabled. This value is automatically overwritten depending on whether PV excess charging or dynamic load management is enabled.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`default_mode`<br/>int</th>
    <td>
        The charge mode used after a Power Manager restart
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`excess_charging_enable`<br/>bool</th>
    <td>
        If enabled, the Power Manager controls the consumers it manages based on the excess of an existing photovoltaic system. If disabled, the maximum power is allowed while complying with the maximum current capacity of the supply lines.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phase_switching_mode`<br/>int</th>
    <td>
        
        - **0** - Automatic switching between three-phase and single-phase charging. Only possible if contactor_installed is true.
        - **1** - Always single-phase
        - **2** - Always three-phase
        - **4** - Single-phase PV mode, three-phase fast mode
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`target_power_from_grid`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Target grid power for excess control. Specifies the desired grid consumption (positive values) or grid feed-in (negative values) in PV charging mode. This can also influence the priority relative to a battery storage system.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`guaranteed_power`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Minimum charging power used for Min + PV charging mode. This power is (partially) drawn from the grid when PV excess is insufficient.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cloud_filter_mode`<br/>int</th>
    <td>
        Cloud filter mode to avoid overreactions to short-term changes in cloud cover in PV charging mode.
        - **0** - No cloud filter.
        - **1** - Weak cloud filter.
        - **2** - Medium cloud filter.
        - **3** - Strong cloud filter.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_battery_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the battery storage meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_mode`<br/>int</th>
    <td>
        Storage priority relative to wallboxes
        - **0** - Prefer wallboxes, excess power for storage
        - **1** - Prefer storage, excess power for wallboxes
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_inverted`<br/>bool</th>
    <td>
        Inverts the sign of storage power for battery storage systems that report negative power values when charging and positive values when discharging.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_deadzone`<br/>int</th>
    <td>
        Grid consumption and feed-in tolerance at the grid connection while storage is active. For battery storage systems that allow a certain amount of consumption and feed-in during discharging or charging. The tolerance should be set to 1.5 times the expected consumption and feed-in.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/dynamic_load_config` {#power_manager_dynamic_load_config_warp2}


Dynamic load management configuration


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Enables dynamic load management.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_currents`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`current_limit`<br/>int</th>
    <td>
        Maximum desired current at the grid connection in milliamperes. This is typically the rated value of the fuse.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`largest_consumer_current`<br/>int</th>
    <td>
        Current demand of the largest individual consumer per phase in milliamperes, excluding controlled wallboxes.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`safety_margin_pct`<br/>int</th>
    <td>
        Additional safety margin in percent, relative to the maximum current at the grid connection.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/state` {#power_manager_state_warp2}


Power Manager state
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp2-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp2/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/state
```
        </TabItem>
    </Tabs>

```jsx
{ "config_error_flags": 0, "external_control": 1 }
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`config_error_flags`<br/>int</th>
    <td>
        Active configuration errors of the Power Manager. This is a bitmask, so any combination of configuration errors can occur.
        - **0** - No error
        - **0x00000001** - Phase switching or contactor not configured
        - **0x00000002** - Maximum total current of wallboxes not configured
        - **0x00000004** - No wallboxes configured
        - **0x00000008** - Excess charging enabled but no electricity meter configured
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`external_control`<br/>int</th>
    <td>
        Status of external control for phase switching.
        - **0** - External control ready for commands.
        - **1** - External control disabled via settings.
        - **2** - External control is enabled but currently unavailable. Reasons include: triggered contactor monitoring, one or more wallboxes unreachable or do not support CP disconnect, charging session blocked by input 3.
        - **3** - Phase switching is currently being performed; incoming commands are ignored.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/low_level_state` {#power_manager_low_level_state_warp2}


The internal state of the Power Manager. Used for displaying debug information. <strong>Changes to this object are not considered an API breaking change!</strong>
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp2-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/low_level_state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp2/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/low_level_state
```
        </TabItem>
    </Tabs>

```jsx
{
  "power_at_meter": -4067.817383,
  "power_at_meter_filtered": -4909,
  "power_available": 3680,
  "power_available_filtered": 3680,
  "overall_min_power": 1380,
  "threshold_3to1": 3795,
  "threshold_1to3": 4025,
  "charge_manager_available_current": 16000,
  "charge_manager_allocated_current": 16000,
  "max_current_limited": 16000,
  "uptime_past_hysteresis": true,
  "is_3phase": false,
  "wants_3phase": false,
  "wants_3phase_last": false,
  "is_on_last": true,
  "wants_on_last": true,
  "phase_state_change_blocked": false,
  "phase_state_change_delay": 0,
  "on_state_change_blocked": true,
  "on_state_change_delay": 194264,
  "charging_blocked": 0,
  "switching_state": 0
}
```


:::



<br/><br/><br/>
## `power_manager/charge_mode` {#power_manager_charge_mode_warp2}


Currently used charge mode.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp2-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
```bash
curl http://$HOST/power_manager/charge_mode -d '{ "mode": 2 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/charge_mode -d '2'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp2/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/charge_mode<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '{ "mode": 2 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '2'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`mode`<br/>int</th>
    <td>
        
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/external_control` {#power_manager_external_control_warp2}


Phase request for external control. Can be written when external_control in [`power_manager/state`](/interfaces/mqtt_http/api_reference/power_manager.mdx#power_manager_state) is 0.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp2-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
```bash
curl http://$HOST/power_manager/external_control -d '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/external_control -d '1'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp2/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/external_control<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '1'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phases_wanted`<br/>int</th>
    <td>
        
        - **0** - No phases requested, no current release.
        - **1** - One phase requested.
        - **3** - Three phases requested.
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="warp3">
## `power_manager/config` {#power_manager_config_warp3}


Power Manager configuration
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp3-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
```bash
curl http://$HOST/power_manager/config -d '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp3/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/config_update -m '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Obsolete. Indicates whether the Power Manager is enabled. This value is automatically overwritten depending on whether PV excess charging or dynamic load management is enabled.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`default_mode`<br/>int</th>
    <td>
        The charge mode used after a Power Manager restart
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`excess_charging_enable`<br/>bool</th>
    <td>
        If enabled, the Power Manager controls the consumers it manages based on the excess of an existing photovoltaic system. If disabled, the maximum power is allowed while complying with the maximum current capacity of the supply lines.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phase_switching_mode`<br/>int</th>
    <td>
        
        - **0** - Automatic switching between three-phase and single-phase charging. Only possible if contactor_installed is true.
        - **1** - Always single-phase
        - **2** - Always three-phase
        - **4** - Single-phase PV mode, three-phase fast mode
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`target_power_from_grid`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Target grid power for excess control. Specifies the desired grid consumption (positive values) or grid feed-in (negative values) in PV charging mode. This can also influence the priority relative to a battery storage system.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`guaranteed_power`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Minimum charging power used for Min + PV charging mode. This power is (partially) drawn from the grid when PV excess is insufficient.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cloud_filter_mode`<br/>int</th>
    <td>
        Cloud filter mode to avoid overreactions to short-term changes in cloud cover in PV charging mode.
        - **0** - No cloud filter.
        - **1** - Weak cloud filter.
        - **2** - Medium cloud filter.
        - **3** - Strong cloud filter.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_battery_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the battery storage meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_mode`<br/>int</th>
    <td>
        Storage priority relative to wallboxes
        - **0** - Prefer wallboxes, excess power for storage
        - **1** - Prefer storage, excess power for wallboxes
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_inverted`<br/>bool</th>
    <td>
        Inverts the sign of storage power for battery storage systems that report negative power values when charging and positive values when discharging.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_deadzone`<br/>int</th>
    <td>
        Grid consumption and feed-in tolerance at the grid connection while storage is active. For battery storage systems that allow a certain amount of consumption and feed-in during discharging or charging. The tolerance should be set to 1.5 times the expected consumption and feed-in.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/dynamic_load_config` {#power_manager_dynamic_load_config_warp3}


Dynamic load management configuration


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Enables dynamic load management.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_currents`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`current_limit`<br/>int</th>
    <td>
        Maximum desired current at the grid connection in milliamperes. This is typically the rated value of the fuse.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`largest_consumer_current`<br/>int</th>
    <td>
        Current demand of the largest individual consumer per phase in milliamperes, excluding controlled wallboxes.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`safety_margin_pct`<br/>int</th>
    <td>
        Additional safety margin in percent, relative to the maximum current at the grid connection.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/state` {#power_manager_state_warp3}


Power Manager state
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp3-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp3/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/state
```
        </TabItem>
    </Tabs>

```jsx
{ "config_error_flags": 0, "external_control": 1 }
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`config_error_flags`<br/>int</th>
    <td>
        Active configuration errors of the Power Manager. This is a bitmask, so any combination of configuration errors can occur.
        - **0** - No error
        - **0x00000001** - Phase switching or contactor not configured
        - **0x00000002** - Maximum total current of wallboxes not configured
        - **0x00000004** - No wallboxes configured
        - **0x00000008** - Excess charging enabled but no electricity meter configured
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`external_control`<br/>int</th>
    <td>
        Status of external control for phase switching.
        - **0** - External control ready for commands.
        - **1** - External control disabled via settings.
        - **2** - External control is enabled but currently unavailable. Reasons include: triggered contactor monitoring, one or more wallboxes unreachable or do not support CP disconnect, charging session blocked by input 3.
        - **3** - Phase switching is currently being performed; incoming commands are ignored.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/low_level_state` {#power_manager_low_level_state_warp3}


The internal state of the Power Manager. Used for displaying debug information. <strong>Changes to this object are not considered an API breaking change!</strong>
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp3-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/low_level_state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp3/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/low_level_state
```
        </TabItem>
    </Tabs>

```jsx
{
  "power_at_meter": -4067.817383,
  "power_at_meter_filtered": -4909,
  "power_available": 3680,
  "power_available_filtered": 3680,
  "overall_min_power": 1380,
  "threshold_3to1": 3795,
  "threshold_1to3": 4025,
  "charge_manager_available_current": 16000,
  "charge_manager_allocated_current": 16000,
  "max_current_limited": 16000,
  "uptime_past_hysteresis": true,
  "is_3phase": false,
  "wants_3phase": false,
  "wants_3phase_last": false,
  "is_on_last": true,
  "wants_on_last": true,
  "phase_state_change_blocked": false,
  "phase_state_change_delay": 0,
  "on_state_change_blocked": true,
  "on_state_change_delay": 194264,
  "charging_blocked": 0,
  "switching_state": 0
}
```


:::



<br/><br/><br/>
## `power_manager/charge_mode` {#power_manager_charge_mode_warp3}


Currently used charge mode.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp3-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
```bash
curl http://$HOST/power_manager/charge_mode -d '{ "mode": 2 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/charge_mode -d '2'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp3/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/charge_mode<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '{ "mode": 2 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '2'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`mode`<br/>int</th>
    <td>
        
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/external_control` {#power_manager_external_control_warp3}


Phase request for external control. Can be written when external_control in [`power_manager/state`](/interfaces/mqtt_http/api_reference/power_manager.mdx#power_manager_state) is 0.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp3-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
```bash
curl http://$HOST/power_manager/external_control -d '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/external_control -d '1'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp3/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/external_control<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '1'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phases_wanted`<br/>int</th>
    <td>
        
        - **0** - No phases requested, no current release.
        - **1** - One phase requested.
        - **3** - Three phases requested.
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="wem">
## `power_manager/config` {#power_manager_config_wem}


Power Manager configuration
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
```bash
curl http://$HOST/power_manager/config -d '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/config_update -m '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Obsolete. Indicates whether the Power Manager is enabled. This value is automatically overwritten depending on whether PV excess charging or dynamic load management is enabled.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`default_mode`<br/>int</th>
    <td>
        The charge mode used after a Power Manager restart
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`excess_charging_enable`<br/>bool</th>
    <td>
        If enabled, the Power Manager controls the consumers it manages based on the excess of an existing photovoltaic system. If disabled, the maximum power is allowed while complying with the maximum current capacity of the supply lines.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phase_switching_mode`<br/>int</th>
    <td>
        
        - **0** - Automatic switching between three-phase and single-phase charging. Only possible if contactor_installed is true.
        - **1** - Always single-phase
        - **2** - Always three-phase
        - **4** - Single-phase PV mode, three-phase fast mode
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`target_power_from_grid`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Target grid power for excess control. Specifies the desired grid consumption (positive values) or grid feed-in (negative values) in PV charging mode. This can also influence the priority relative to a battery storage system.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`guaranteed_power`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Minimum charging power used for Min + PV charging mode. This power is (partially) drawn from the grid when PV excess is insufficient.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cloud_filter_mode`<br/>int</th>
    <td>
        Cloud filter mode to avoid overreactions to short-term changes in cloud cover in PV charging mode.
        - **0** - No cloud filter.
        - **1** - Weak cloud filter.
        - **2** - Medium cloud filter.
        - **3** - Strong cloud filter.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_battery_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the battery storage meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_mode`<br/>int</th>
    <td>
        Storage priority relative to wallboxes
        - **0** - Prefer wallboxes, excess power for storage
        - **1** - Prefer storage, excess power for wallboxes
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_inverted`<br/>bool</th>
    <td>
        Inverts the sign of storage power for battery storage systems that report negative power values when charging and positive values when discharging.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_deadzone`<br/>int</th>
    <td>
        Grid consumption and feed-in tolerance at the grid connection while storage is active. For battery storage systems that allow a certain amount of consumption and feed-in during discharging or charging. The tolerance should be set to 1.5 times the expected consumption and feed-in.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/dynamic_load_config` {#power_manager_dynamic_load_config_wem}


Dynamic load management configuration


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Enables dynamic load management.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_currents`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`current_limit`<br/>int</th>
    <td>
        Maximum desired current at the grid connection in milliamperes. This is typically the rated value of the fuse.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`largest_consumer_current`<br/>int</th>
    <td>
        Current demand of the largest individual consumer per phase in milliamperes, excluding controlled wallboxes.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`safety_margin_pct`<br/>int</th>
    <td>
        Additional safety margin in percent, relative to the maximum current at the grid connection.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/state` {#power_manager_state_wem}


Power Manager state
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/state
```
        </TabItem>
    </Tabs>

```jsx
{ "config_error_flags": 0, "external_control": 1 }
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`config_error_flags`<br/>int</th>
    <td>
        Active configuration errors of the Power Manager. This is a bitmask, so any combination of configuration errors can occur.
        - **0** - No error
        - **0x00000001** - Phase switching or contactor not configured
        - **0x00000002** - Maximum total current of wallboxes not configured
        - **0x00000004** - No wallboxes configured
        - **0x00000008** - Excess charging enabled but no electricity meter configured
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`external_control`<br/>int</th>
    <td>
        Status of external control for phase switching.
        - **0** - External control ready for commands.
        - **1** - External control disabled via settings.
        - **2** - External control is enabled but currently unavailable. Reasons include: triggered contactor monitoring, one or more wallboxes unreachable or do not support CP disconnect, charging session blocked by input 3.
        - **3** - Phase switching is currently being performed; incoming commands are ignored.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/low_level_state` {#power_manager_low_level_state_wem}


The internal state of the Power Manager. Used for displaying debug information. <strong>Changes to this object are not considered an API breaking change!</strong>
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/low_level_state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/low_level_state
```
        </TabItem>
    </Tabs>

```jsx
{
  "power_at_meter": -4067.817383,
  "power_at_meter_filtered": -4909,
  "power_available": 3680,
  "power_available_filtered": 3680,
  "overall_min_power": 1380,
  "threshold_3to1": 3795,
  "threshold_1to3": 4025,
  "charge_manager_available_current": 16000,
  "charge_manager_allocated_current": 16000,
  "max_current_limited": 16000,
  "uptime_past_hysteresis": true,
  "is_3phase": false,
  "wants_3phase": false,
  "wants_3phase_last": false,
  "is_on_last": true,
  "wants_on_last": true,
  "phase_state_change_blocked": false,
  "phase_state_change_delay": 0,
  "on_state_change_blocked": true,
  "on_state_change_delay": 194264,
  "charging_blocked": 0,
  "switching_state": 0
}
```


:::



<br/><br/><br/>
## `power_manager/charge_mode` {#power_manager_charge_mode_wem}


Currently used charge mode.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
```bash
curl http://$HOST/power_manager/charge_mode -d '{ "mode": 2 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/charge_mode -d '2'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/charge_mode<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '{ "mode": 2 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '2'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`mode`<br/>int</th>
    <td>
        
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/external_control` {#power_manager_external_control_wem}


Phase request for external control. Can be written when external_control in [`power_manager/state`](/interfaces/mqtt_http/api_reference/power_manager.mdx#power_manager_state) is 0.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
```bash
curl http://$HOST/power_manager/external_control -d '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/external_control -d '1'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/external_control<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '1'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phases_wanted`<br/>int</th>
    <td>
        
        - **0** - No phases requested, no current release.
        - **1** - One phase requested.
        - **3** - Three phases requested.
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="wem2">
## `power_manager/config` {#power_manager_config_wem2}


Power Manager configuration
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem2-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
```bash
curl http://$HOST/power_manager/config -d '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem2/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/config_update -m '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Obsolete. Indicates whether the Power Manager is enabled. This value is automatically overwritten depending on whether PV excess charging or dynamic load management is enabled.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`default_mode`<br/>int</th>
    <td>
        The charge mode used after a Power Manager restart
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`excess_charging_enable`<br/>bool</th>
    <td>
        If enabled, the Power Manager controls the consumers it manages based on the excess of an existing photovoltaic system. If disabled, the maximum power is allowed while complying with the maximum current capacity of the supply lines.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phase_switching_mode`<br/>int</th>
    <td>
        
        - **0** - Automatic switching between three-phase and single-phase charging. Only possible if contactor_installed is true.
        - **1** - Always single-phase
        - **2** - Always three-phase
        - **4** - Single-phase PV mode, three-phase fast mode
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`target_power_from_grid`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Target grid power for excess control. Specifies the desired grid consumption (positive values) or grid feed-in (negative values) in PV charging mode. This can also influence the priority relative to a battery storage system.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`guaranteed_power`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Minimum charging power used for Min + PV charging mode. This power is (partially) drawn from the grid when PV excess is insufficient.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cloud_filter_mode`<br/>int</th>
    <td>
        Cloud filter mode to avoid overreactions to short-term changes in cloud cover in PV charging mode.
        - **0** - No cloud filter.
        - **1** - Weak cloud filter.
        - **2** - Medium cloud filter.
        - **3** - Strong cloud filter.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_battery_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the battery storage meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_mode`<br/>int</th>
    <td>
        Storage priority relative to wallboxes
        - **0** - Prefer wallboxes, excess power for storage
        - **1** - Prefer storage, excess power for wallboxes
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_inverted`<br/>bool</th>
    <td>
        Inverts the sign of storage power for battery storage systems that report negative power values when charging and positive values when discharging.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_deadzone`<br/>int</th>
    <td>
        Grid consumption and feed-in tolerance at the grid connection while storage is active. For battery storage systems that allow a certain amount of consumption and feed-in during discharging or charging. The tolerance should be set to 1.5 times the expected consumption and feed-in.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/dynamic_load_config` {#power_manager_dynamic_load_config_wem2}


Dynamic load management configuration


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Enables dynamic load management.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_currents`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`current_limit`<br/>int</th>
    <td>
        Maximum desired current at the grid connection in milliamperes. This is typically the rated value of the fuse.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`largest_consumer_current`<br/>int</th>
    <td>
        Current demand of the largest individual consumer per phase in milliamperes, excluding controlled wallboxes.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`safety_margin_pct`<br/>int</th>
    <td>
        Additional safety margin in percent, relative to the maximum current at the grid connection.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/state` {#power_manager_state_wem2}


Power Manager state
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem2-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem2/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/state
```
        </TabItem>
    </Tabs>

```jsx
{ "config_error_flags": 0, "external_control": 1 }
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`config_error_flags`<br/>int</th>
    <td>
        Active configuration errors of the Power Manager. This is a bitmask, so any combination of configuration errors can occur.
        - **0** - No error
        - **0x00000001** - Phase switching or contactor not configured
        - **0x00000002** - Maximum total current of wallboxes not configured
        - **0x00000004** - No wallboxes configured
        - **0x00000008** - Excess charging enabled but no electricity meter configured
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`external_control`<br/>int</th>
    <td>
        Status of external control for phase switching.
        - **0** - External control ready for commands.
        - **1** - External control disabled via settings.
        - **2** - External control is enabled but currently unavailable. Reasons include: triggered contactor monitoring, one or more wallboxes unreachable or do not support CP disconnect, charging session blocked by input 3.
        - **3** - Phase switching is currently being performed; incoming commands are ignored.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/low_level_state` {#power_manager_low_level_state_wem2}


The internal state of the Power Manager. Used for displaying debug information. <strong>Changes to this object are not considered an API breaking change!</strong>
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem2-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/low_level_state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem2/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/low_level_state
```
        </TabItem>
    </Tabs>

```jsx
{
  "power_at_meter": -4067.817383,
  "power_at_meter_filtered": -4909,
  "power_available": 3680,
  "power_available_filtered": 3680,
  "overall_min_power": 1380,
  "threshold_3to1": 3795,
  "threshold_1to3": 4025,
  "charge_manager_available_current": 16000,
  "charge_manager_allocated_current": 16000,
  "max_current_limited": 16000,
  "uptime_past_hysteresis": true,
  "is_3phase": false,
  "wants_3phase": false,
  "wants_3phase_last": false,
  "is_on_last": true,
  "wants_on_last": true,
  "phase_state_change_blocked": false,
  "phase_state_change_delay": 0,
  "on_state_change_blocked": true,
  "on_state_change_delay": 194264,
  "charging_blocked": 0,
  "switching_state": 0
}
```


:::



<br/><br/><br/>
## `power_manager/charge_mode` {#power_manager_charge_mode_wem2}


Currently used charge mode.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem2-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
```bash
curl http://$HOST/power_manager/charge_mode -d '{ "mode": 2 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/charge_mode -d '2'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem2/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/charge_mode<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '{ "mode": 2 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '2'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`mode`<br/>int</th>
    <td>
        
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/external_control` {#power_manager_external_control_wem2}


Phase request for external control. Can be written when external_control in [`power_manager/state`](/interfaces/mqtt_http/api_reference/power_manager.mdx#power_manager_state) is 0.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. wem2-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
```bash
curl http://$HOST/power_manager/external_control -d '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/external_control -d '1'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. wem2/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/external_control<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '1'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phases_wanted`<br/>int</th>
    <td>
        
        - **0** - No phases requested, no current release.
        - **1** - One phase requested.
        - **3** - Three phases requested.
    </td>
</tr>
    </tbody>
</table>
</TabItem>
<TabItem value="any">
## `power_manager/config` {#power_manager_config_any}


Power Manager configuration
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
```bash
curl http://$HOST/power_manager/config -d '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/config
```
```jsx
{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/config<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/config_update -m '{
  "enabled": true,
  "phase_switching_mode": 1,
  "excess_charging_enable": true,
  "default_mode": 0,
  "meter_slot_grid_power": 3,
  "target_power_from_grid": 0,
  "guaranteed_power": 1380,
  "cloud_filter_mode": 2
}'
```



        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Obsolete. Indicates whether the Power Manager is enabled. This value is automatically overwritten depending on whether PV excess charging or dynamic load management is enabled.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`default_mode`<br/>int</th>
    <td>
        The charge mode used after a Power Manager restart
        
        
        
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`excess_charging_enable`<br/>bool</th>
    <td>
        If enabled, the Power Manager controls the consumers it manages based on the excess of an existing photovoltaic system. If disabled, the maximum power is allowed while complying with the maximum current capacity of the supply lines.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phase_switching_mode`<br/>int</th>
    <td>
        
        
        
        
        - **0** - Automatic switching between three-phase and single-phase charging. Only possible if contactor_installed is true.
        - **1** - Always single-phase
        - **2** - Always three-phase
        - **4** - Single-phase PV mode, three-phase fast mode
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`target_power_from_grid`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Target grid power for excess control. Specifies the desired grid consumption (positive values) or grid feed-in (negative values) in PV charging mode. This can also influence the priority relative to a battery storage system.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`guaranteed_power`<br/>int (<abbr title="Watt">W</abbr>)</th>
    <td>
        Minimum charging power used for Min + PV charging mode. This power is (partially) drawn from the grid when PV excess is insufficient.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`cloud_filter_mode`<br/>int</th>
    <td>
        Cloud filter mode to avoid overreactions to short-term changes in cloud cover in PV charging mode.
        
        
        
        - **0** - No cloud filter.
        - **1** - Weak cloud filter.
        - **2** - Medium cloud filter.
        - **3** - Strong cloud filter.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_battery_power`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the battery storage meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_mode`<br/>int</th>
    <td>
        Storage priority relative to wallboxes
        
        
        
        - **0** - Prefer wallboxes, excess power for storage
        - **1** - Prefer storage, excess power for wallboxes
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_inverted`<br/>bool</th>
    <td>
        Inverts the sign of storage power for battery storage systems that report negative power values when charging and positive values when discharging.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`battery_deadzone`<br/>int</th>
    <td>
        Grid consumption and feed-in tolerance at the grid connection while storage is active. For battery storage systems that allow a certain amount of consumption and feed-in during discharging or charging. The tolerance should be set to 1.5 times the expected consumption and feed-in.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/dynamic_load_config` {#power_manager_dynamic_load_config_any}


Dynamic load management configuration


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`enabled`<br/>bool</th>
    <td>
        Enables dynamic load management.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`meter_slot_grid_currents`<br/>int</th>
    <td>
        Specifies which electricity meter is considered the grid connection meter for control.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`current_limit`<br/>int</th>
    <td>
        Maximum desired current at the grid connection in milliamperes. This is typically the rated value of the fuse.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`largest_consumer_current`<br/>int</th>
    <td>
        Current demand of the largest individual consumer per phase in milliamperes, excluding controlled wallboxes.
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`safety_margin_pct`<br/>int</th>
    <td>
        Additional safety margin in percent, relative to the maximum current at the grid connection.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/state` {#power_manager_state_any}


Power Manager state
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/state
```
        </TabItem>
    </Tabs>

```jsx
{ "config_error_flags": 0, "external_control": 1 }
```


:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`config_error_flags`<br/>int</th>
    <td>
        Active configuration errors of the Power Manager. This is a bitmask, so any combination of configuration errors can occur.
        
        
        
        - **0** - No error
        - **0x00000001** - Phase switching or contactor not configured
        - **0x00000002** - Maximum total current of wallboxes not configured
        - **0x00000004** - No wallboxes configured
        - **0x00000008** - Excess charging enabled but no electricity meter configured
    </td>
</tr>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`external_control`<br/>int</th>
    <td>
        Status of external control for phase switching.
        
        
        
        - **0** - External control ready for commands.
        - **1** - External control disabled via settings.
        - **2** - External control is enabled but currently unavailable. Reasons include: triggered contactor monitoring, one or more wallboxes unreachable or do not support CP disconnect, charging session blocked by input 3.
        - **3** - Phase switching is currently being performed; incoming commands are ignored.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/low_level_state` {#power_manager_low_level_state_any}


The internal state of the Power Manager. Used for displaying debug information. <strong>Changes to this object are not considered an API breaking change!</strong>
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```
#### Read
```bash
curl http://$HOST/power_manager/low_level_state
```
        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```
#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/low_level_state
```
        </TabItem>
    </Tabs>

```jsx
{
  "power_at_meter": -4067.817383,
  "power_at_meter_filtered": -4909,
  "power_available": 3680,
  "power_available_filtered": 3680,
  "overall_min_power": 1380,
  "threshold_3to1": 3795,
  "threshold_1to3": 4025,
  "charge_manager_available_current": 16000,
  "charge_manager_allocated_current": 16000,
  "max_current_limited": 16000,
  "uptime_past_hysteresis": true,
  "is_3phase": false,
  "wants_3phase": false,
  "wants_3phase_last": false,
  "is_on_last": true,
  "wants_on_last": true,
  "phase_state_change_blocked": false,
  "phase_state_change_delay": 0,
  "on_state_change_blocked": true,
  "on_state_change_delay": 194264,
  "charging_blocked": 0,
  "switching_state": 0
}
```


:::



<br/><br/><br/>
## `power_manager/charge_mode` {#power_manager_charge_mode_any}


Currently used charge mode.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
```bash
curl http://$HOST/power_manager/charge_mode -d '{ "mode": 2 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/charge_mode -d '2'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/charge_mode
```
```jsx
{ "mode": 2 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/charge_mode<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '{ "mode": 2 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/charge_mode_update -m '2'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`mode`<br/>int</th>
    <td>
        
        
        
        
        - **0** - Fast. Charges vehicles as quickly as possible, even if grid power is required.
        - **1** - Off. Vehicles are not charged.
        - **2** - PV. Vehicles are only charged from PV excess. Only available if excess_charging_enable is true.
        - **3** - Min + PV. Allows the configured minimum charging power (guaranteed_power), even if it must be (partially) drawn from the grid. If greater PV excess is available, it is used. Only available if excess_charging_enable is true.
    </td>
</tr>
    </tbody>
</table>

<br/><br/><br/>
## `power_manager/external_control` {#power_manager_external_control_any}


Phase request for external control. Can be written when external_control in [`power_manager/state`](/interfaces/mqtt_http/api_reference/power_manager.mdx#power_manager_state) is 0.
:::info[Example]
    <Tabs groupId="apiType" queryString className="hidden-tabs">
        <TabItem value="http" label="HTTP (curl)">
```bash
# $HOST e.g. warp-AbCd
```

#### Read
```bash
curl http://$HOST/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
```bash
curl http://$HOST/power_manager/external_control -d '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
curl http://$HOST/power_manager/external_control -d '1'
```




        </TabItem>
        <TabItem value="mqtt" label="MQTT (mosquitto)">
```bash
# $BROKER e.g. my_mosquitto.localdomain
# $PREFIX e.g. warp/AbCd
```

#### Read
```bash
mosquitto_sub -v -C 1 -h $BROKER -t $PREFIX/power_manager/external_control
```
```jsx
{ "phases_wanted": 1 }
```



#### Write
            With MQTT on <code>$PREFIX/power_manager/external_control<strong>_update</strong></code>


```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '{ "phases_wanted": 1 }'
```

or abbreviated:

```bash
mosquitto_pub -h $BROKER -t $PREFIX/power_manager/external_control_update -m '1'
```




        </TabItem>
    </Tabs>
:::


<table>
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Meaning</th>
        </tr>
    </thead>
    <tbody>

<tr>
    <th scope="row" style={{whiteSpace: "nowrap"}}>`phases_wanted`<br/>int</th>
    <td>
        
        
        
        
        - **0** - No phases requested, no current release.
        - **1** - One phase requested.
        - **3** - Three phases requested.
    </td>
</tr>
    </tbody>
</table>
</TabItem>
</Tabs>

export const toc = [
    {
    "value": "power_manager/config",
    "id": "power_manager_config",
    "level": 2,
    
},{
    "value": "power_manager/dynamic_load_config",
    "id": "power_manager_dynamic_load_config",
    "level": 2,
    
},{
    "value": "power_manager/state",
    "id": "power_manager_state",
    "level": 2,
    
},{
    "value": "power_manager/low_level_state",
    "id": "power_manager_low_level_state",
    "level": 2,
    
},{
    "value": "power_manager/charge_mode",
    "id": "power_manager_charge_mode",
    "level": 2,
    
},{
    "value": "power_manager/external_control",
    "id": "power_manager_external_control",
    "level": 2,
    
},
];
